IBM XL Fortran for AIX, V12.1 (5724-U82) Version 12.01.0000.0001 --- /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/FILLH.f 12/22/08 15:45:50
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             ESCAPE          FULLPATH
         I4              INLGLUE         NOLIBESSL       NOLIBPOSIX
         OBJECT          SOURCE          STRICT          SWAPOMP
         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         ALIAS_SIZE(65536)     FIXED(72)             MAXMEM(-1)
         OPTIMIZE(2)           SPILLSIZE(2000)       STACKTEMP(0)
  
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR6)            ATTR(FULL)            AUTODBL(NONE)
         DESCRIPTOR(V1)        DIRECTIVE(IBM*,IBMT)  ENUM()
         FLAG(I,I)             FLOAT(RNDSNGL,MAF,FOLD,RNGCHK,SINGLE)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         SAVE(ALL)             TUNE(PWR6)            UNROLL(AUTO)
         XREF(FULL)            XLF2003(NOPOLYMORPHIC,NOBOZLITARGS,NOSTOPEXCEPT,NOVOLATILE,NOAUTOREALLOC,OLDNANINF)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC,OLDPAD)
  
>>>>> SOURCE SECTION <<<<<
          1 |      SUBROUTINE FILLH(ARR1,ARR2,IDIM,JDIM)
          2 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          3 |C                .      .    .
          4 |C SUBPROGRAM:    FILLH       FILL H POINTS ON E-GRID V FIELD
          5 |C   PRGRMMR: BLACK           ORG: W/NP2      DATE: 92-12-23
          6 |C
          7 |C ABSTRACT:
          8 |C     THIS ROUTINE FILLS MASS (H) POINTS ON A VELOCITY (V)
          9 |C     POINT E-GRID.
         10 |C   .
         11 |C
         12 |C PROGRAM HISTORY LOG:
         13 |C   ??-??-??  BLACK - ORIGINATOR
         14 |C   93-12-23  RUSS TREADON - ADDED COMMENTS AND VARIABLE
         15 |C                            GRID DIMENSIONS TO
         16 |C                            SUBROUTINE CALL.
         17 |C   98-06-04  BLACK - CONVERSION TO 2-D
         18 |C
         19 |C USAGE:    CALL FILLH(ARR1,ARR2,IDIM,JDIM)
         20 |C   INPUT ARGUMENT LIST:
         21 |C     ARR2     - VELOCITY POINT DATA ON STAGGERED E-GRID.
         22 |C     IDIM     - FIRST DIMENSION OF FILLED E-GRID.
         23 |C     JDIM     - SECOND DIMENSION OF FILLED E-GRID.
         24 |C
         25 |C   OUTPUT ARGUMENT LIST:
         26 |C     ARR1     - VELOCITY POINT DATA ON FILLED E-GRID.
         27 |C
         28 |C   OUTPUT FILES:
         29 |C     NONE
         30 |C
         31 |C   SUBPROGRAMS CALLED:
         32 |C     UTILITIES:
         33 |C       EFILL - FILL MISSING VALUES ON STAGGERED
         34 |C               E-GRID WITH FIELD MEAN.
         35 |C     LIBRARY:
         36 |C       COMMON
         37 |C
         38 |C   ATTRIBUTES:
         39 |C     LANGUAGE: FORTRAN
         40 |C     MACHINE : CRAY C-90
         41 |C$$$
         42 |C
         43 |C--------------------------------------------------------------------
         44 |                        D I M E N S I O N
         45 |     & ARR1((IDIM+1)/2,JDIM), ARR2(IDIM,JDIM)
         46 |C
         47 |C********************************************************************
         48 |C     START FILLH HERE.
         49 |C
         50 |C     REPLACE MISSING VALUES ON EGRID WITH FIELD MEAN
         51 |      IM=(IDIM+1)/2
         52 |      CALL EFILL(ARR1,IM,JDIM)
         53 |C
         54 |      DO J=1,JDIM
         55 |      DO I=1,IDIM
         56 |        ARR2(I,J)=0.
         57 |      ENDDO
         58 |      ENDDO
         59 |C***
         60 |C***  REASSIGN VALUES OF MODEL GRID TO V POINTS ON IDIM X JDIM GRID
         61 |C***  ON ODD ROWS.
         62 |C***
         63 |      DO J=1,JDIM,2
         64 |      DO I=2,IDIM-1,2
         65 |        II=I/2
         66 |        ARR2(I,J)=ARR1(II,J)
         67 |      ENDDO
         68 |      ENDDO
         69 |C***
         70 |C***  REASSIGN VALUES OF MODEL GRID TO V POINTS ON IDIM X JDIM GRID
         71 |C***  ON EVEN ROWS.
         72 |C***
         73 |      DO J=2,JDIM-1,2
         74 |      DO I=1,IDIM,2
         75 |        II=(I+1)/2
         76 |        ARR2(I,J)=ARR1(II,J)
         77 |      ENDDO
         78 |      ENDDO
         79 |C***
         80 |C***  INTERPOLATE VALUES TO THOSE CORRESPONDING TO H POINTS ON THE
         81 |C***  IDIM X JDIM GRID ON THE BOTTOM AND TOP ROWS.
         82 |C***
         83 |      DO I=3,IDIM-2,2
         84 |        II=I/2
         85 |        ARR2(I,1)=(ARR1(II,1)+ARR1(II+1,1))*0.5
         86 |        ARR2(I,JDIM)=(ARR1(II,JDIM)+ARR1(II+1,JDIM))*0.5
         87 |      ENDDO
         88 |C***
         89 |C***  INTERPOLATE VALUES TO THOSE CORRESPONDING TO H POINTS ON THE
         90 |C***  IDIM X JDIM GRID ON THE WEST AND EAST SIDES.
         91 |C***
         92 |      DO J=3,JDIM-2,2
         93 |        ARR2(1,J)=(ARR1(1,J+1)+ARR1(1,J-1))*0.5
         94 |        ARR2(IDIM,J)=(ARR1(IM,J+1)+ARR1(IM,J-1))*0.5
         95 |      ENDDO
         96 |C***
         97 |C***  INTERPOLATE TO CORRESPONDING H POINTS ON ODD ROWS
         98 |C***  EXCLUDING THE SIDES.
         99 |C***
        100 |      DO J=3,JDIM-2,2
        101 |      DO I=3,IDIM-2,2
        102 |        II=I/2
        103 |        ARR2(I,J)=0.25*(ARR1(II,J)+ARR1(II+1,J)+ARR1(II+1,J+1)+
        104 |     1                  ARR1(II+1,J-1))
        105 |      ENDDO
        106 |      ENDDO
        107 |C***
        108 |C***  INTERPOLATE TO CORRESPONDING H POINTS ON EVEN ROWS
        109 |C***  EXCLUDING THE SIDES.
        110 |C***
        111 |      DO J=2,JDIM-1,2
        112 |      DO I=2,IDIM-1,2
        113 |        II=I/2
        114 |        ARR2(I,J)=0.25*(ARR1(II,J)+ARR1(II+1,J)+ARR1(II,J+1)+
        115 |     1                  ARR1(II,J-1))
        116 |      ENDDO
        117 |      ENDDO
        118 |C***
        119 |C***  EXTRAPOLATE TO THE FOUR CORNER H POINTS.
        120 |C***
        121 |      ARR2(1,1)=0.5*(1.5*(ARR1(1,1)+ARR1(1,2))
        122 |     1              -0.5*(ARR1(2,1)+ARR1(1,4)))
        123 |      ARR2(IDIM,1)=0.5*(1.5*(ARR1(IM-1,1)+ARR1(IM,2))
        124 |     1              -0.5*(ARR1(IM-2,1)+ARR1(IM,4)))
        125 |      ARR2(1,JDIM)=0.5*(1.5*(ARR1(1,JDIM)+ARR1(1,JDIM-1))
        126 |     1              -0.5*(ARR1(2,JDIM)+ARR1(1,JDIM-3)))
        127 |      ARR2(IDIM,JDIM)=0.5*(1.5*(ARR1(IM-1,JDIM)+ARR1(IM,JDIM-1))
        128 |     1              -0.5*(ARR1(IM-2,JDIM)+ARR1(IM,JDIM-3)))
        129 |      RETURN
        130 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
arr1                             Reference argument, Real(4) (1:?, 1:?), Offset: 0, Alignment: full word
                                 0-45.8$  0-1.24  0-52.18  0-66.19  0-76.19  0-85.20  0-85.31  0-86.23  0-86.37  0-93.20  0-93.32
                                 0-94.23  0-94.36  0-103.25  0-103.36  0-103.49  0-104.25  0-114.25  0-114.36  0-114.49  0-115.25
                                 0-121.27  0-121.37  0-122.27  0-122.37  0-123.30  0-123.43  0-124.27  0-124.40  0-125.30  0-125.43
                                 0-126.27  0-126.40  0-127.33  0-127.49  0-128.27  0-128.43
 
arr2                             Reference argument, Real(4) (1:?, 1:?), Offset: 0, Alignment: full word
                                 0-45.31$  0-1.29  0-56.9@  0-66.9@  0-76.9@  0-85.9@  0-86.9@  0-93.9@  0-94.9@  0-103.9@  0-114.9@
                                 0-121.7@  0-123.7@  0-125.7@  0-127.7@
 
efill                            External Subroutine
                                 0-52.12
 
fillh                            Subroutine
                                 0-1.18$
 
i                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-55.10@  0-56.14  0-64.10@  0-65.12  0-66.14  0-74.10@  0-75.13  0-76.14  0-83.10@  0-84.12
                                 0-85.14  0-86.14  0-101.10@  0-102.12  0-103.14  0-112.10@  0-113.12  0-114.14
 
idim                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.34  0-45.14  0-45.14  0-45.36  0-45.36  0-51.11  0-55.14  0-64.14  0-74.14  0-83.14  0-94.14
                                 0-101.14  0-112.14  0-123.12  0-127.12
 
ii                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-65.9@  0-66.24  0-75.9@  0-76.24  0-84.9@  0-85.25  0-85.36  0-86.28  0-86.42  0-102.9@  0-103.30
                                 0-103.41  0-103.54  0-104.30  0-113.9@  0-114.30  0-114.41  0-114.54  0-115.30
 
im                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-51.7@  0-52.23  0-94.28  0-94.41  0-123.35  0-123.48  0-124.32  0-124.45  0-127.38  0-127.54
                                 0-128.32  0-128.48
 
j                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-54.10@  0-56.16  0-63.10@  0-66.16  0-66.27  0-73.10@  0-76.16  0-76.27  0-92.10@  0-93.16
                                 0-93.27  0-93.39  0-94.19  0-94.31  0-94.44  0-100.10@  0-103.16  0-103.33  0-103.46  0-103.59
                                 0-104.35  0-111.10@  0-114.16  0-114.33  0-114.46  0-114.57  0-115.33
 
jdim                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.39  0-45.24  0-45.24  0-45.41  0-45.41  0-52.26  0-54.14  0-63.14  0-73.14  0-86.16  0-86.31
                                 0-86.47  0-92.14  0-100.14  0-111.14  0-125.14  0-125.37  0-125.50  0-126.34  0-126.47  0-127.17
                                 0-127.43  0-127.57  0-128.37  0-128.51
 
** fillh   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    FILLH.f                     12/18/08   11:40:51
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     130
1501-510  Compilation successful for file FILLH.f.
1501-543  Object file created.
