IBM XL Fortran for AIX, V12.1 (5724-U82) Version 12.01.0000.0001 --- /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/INTERP3.f 12/22/08 15:45:55
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             ESCAPE          FULLPATH
         I4              INLGLUE         NOLIBESSL       NOLIBPOSIX
         OBJECT          SOURCE          STRICT          SWAPOMP
         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         ALIAS_SIZE(65536)     FIXED(72)             MAXMEM(-1)
         OPTIMIZE(2)           SPILLSIZE(2000)       STACKTEMP(0)
  
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR6)            ATTR(FULL)            AUTODBL(NONE)
         DESCRIPTOR(V1)        DIRECTIVE(IBM*,IBMT)  ENUM()
         FLAG(I,I)             FLOAT(RNDSNGL,MAF,FOLD,RNGCHK,SINGLE)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         SAVE(ALL)             TUNE(PWR6)            UNROLL(AUTO)
         XREF(FULL)            XLF2003(NOPOLYMORPHIC,NOBOZLITARGS,NOSTOPEXCEPT,NOVOLATILE,NOAUTOREALLOC,OLDNANINF)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC,OLDPAD)
  
>>>>> SOURCE SECTION <<<<<
          1 |      SUBROUTINE INTERP3(EGFUL,GDOUT,IMOT,JMOT)
          2 |C
          3 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          4 |C                .      .    .
          5 |C SUBPROGRAM:    INTERP3     BILINEAR INTERPOLATION
          6 |C   PRGRMMR: TREADON         ORG: W/NP2      DATE: 92-12-23
          7 |C
          8 |C ABSTRACT:
          9 |C     THIS ROUTINE BILINEARLY INTERPOLATES DATA FROM A
         10 |C     REGULAR INPUT GRID (FILLED E-GRID) TO A SPECIFIED
         11 |C     REGULAR OUTPUT GRID.  THE ROUTINE ASSUMES THE
         12 |C     INTERPOLATION COEFFICIENTS HAVE BEEN PRECOMPUTED
         13 |C     EITHER EARLIER IN THE POST RUN BY SUBROUTINE GENBIL
         14 |C     OR READ IN WHILE IN SUBROUTINE READCNTRL2.
         15 |C   .
         16 |C
         17 |C PROGRAM HISTORY LOG:
         18 |C   ??-??-??  DAVID PLUMMER - SUBROUTINE INTERP
         19 |C   92-12-23  RUSS TREADON - BROKE INTERP INTO SEVERAL PIECES
         20 |C                            ONE OF WHICH BECAME THIS
         21 |C                            INTERPOLATION ROUTINE.
         22 |C   95-05-03  MIKE BALDWIN - ADDED BIT MAP ARRAY
         23 |C
         24 |C USAGE:    CALL INTERP3(EGFUL,GDOUT,IMOT,JMOT)
         25 |C   INPUT ARGUMENT LIST:
         26 |C     EGFUL    - DATA ON FILLED E-GRID.
         27 |C     IMOT     - FIRST DIMENSION OF OUTPUT GRID.
         28 |C     JMOT     - SECOND DIMENSION OF OUTPUT GRID.
         29 |C
         30 |C   OUTPUT ARGUMENT LIST:
         31 |C     GDOUT    - DATA INTERPOLATED TO OUTPUT GRID.
         32 |C
         33 |C   OUTPUT FILES:
         34 |C     STDOUT  - RUN TIME STANDARD OUT.
         35 |C
         36 |C   SUBPROGRAMS CALLED:
         37 |C     UTILITIES:
         38 |C       EXTEND   - FILLS MISSING VALUES ON OUTPUT GRID WITH
         39 |C                  EITHER AN EXTENSION OF BORDER VALUES OR
         40 |C                  THE FIELD MEAN.
         41 |C     LIBRARY:
         42 |C       COMMON   - OPTIONS
         43 |C                  LLGRDS
         44 |C                  IOUNIT
         45 |C
         46 |C   ATTRIBUTES:
         47 |C     LANGUAGE: FORTRAN
         48 |C     MACHINE : CRAY Y-MP
         49 |C$$$
         50 |C
         51 |C
         52 |C     INCLUDE DECLARED GRID DIMENSIONS.
         53 |C-----------------------------------------------------------------
         54 |      INCLUDE "parmeta"
  1       1 |C-------------------------------------------------------------
  1       2 |C***  SET PRIMARY GRID DIMENSIONS AND PRESSURE OUTPUT LEVELS
  1       3 |      PARAMETER (IM=89,JM=143,LM=60,LSM=39)
  1       4 |C-------------------------------------------------------------
  1       5 |C***  SET THE NUMBER OF PEs IN THE I-DIRECTION AND J-DIRECTION
  1       6 |      PARAMETER(INPES=5,JNPES=6)
  1       7 |C-------------------------------------------------------------
  1       8 |C
  1       9 |      PARAMETER(IGSTL=-5,IGSTR=5)
  1      10 |      PARAMETER(JGSTL=-5,JGSTR=5)
  1      11 |      PARAMETER(ITAIL=IM-(INPES*(IM/INPES)))
  1      12 |      PARAMETER(JTAIL=JM-(JNPES*(JM/JNPES)))
  1      13 |C
  1      14 |      PARAMETER(IDIM1=IGSTL,IDIM2=IM/INPES+IGSTR+1)
  1      15 |      PARAMETER(JDIM1=JGSTL,JDIM2=JM/JNPES+JGSTR+1)
  1      16 |C
  1      17 |C-------------------------------------------------------------
         55 |      INCLUDE "parmout"
  2       1 |C     MAXIMUM DIMENSIONS FOR OUTPUT GRID, FIELDS, AND LEVELS.
  2       2 |C
  2       3 |      PARAMETER(IMX=IM,JMX=JM,MXFLD=250,MXLVL=LM)
         56 |C-----------------------------------------------------------------
         57 |      PARAMETER (IMT=2*IM-1,JMT=JM)
         58 |C
         59 |C     DECLARE VARIABLES.
         60 |C-----------------------------------------------------------------
         61 |      INTEGER IMOT,JMOT
         62 |      REAL EGFUL(IMT,JMT),GDOUT(IMOT,JMOT)
         63 |      DOUBLE PRECISION SUM
         64 |C-----------------------------------------------------------------
         65 |C
         66 |C     INCLUDE COMMON.
         67 |      INCLUDE "OPTIONS.comm"
  3       1 |C
  3       2 |      COMMON /OPTIONS/ SPVAL,IBESSL,KSB,IOFFS,IFLAG,SATDEL
         68 |      INCLUDE "LLGRDS.comm"
  4       1 |C
  4       2 |      COMMON /LLGRDS/
  4       3 |     & GDLAT(IMX,JMX),GDLON(IMX,JMX)
  4       4 |     &,GDTLAT(IMX,JMX),GDTLON(IMX,JMX)
  4       5 |     &,HTLAT(IM,JM),HTLON(IM,JM)
  4       6 |     &,IEGRDK(IM,JM),JEGRDK(IM,JM)
  4       7 |     &,VTLAT(IM,JM),VTLON(IM,JM),FVTLON(IMT,JMT)
  4       8 |     &,EVLAT(IMT,JMT),EVLON(IMT,JMT)
  4       9 |     &,EGRDI(IMX,JMX),EGRDJ(IMX,JMX)
  4      10 |     &,IEGRD(IMX,JMX),JEGRD(IMX,JMX)
  4      11 |     &,IWGT(IMX,JMX),WIJ(IMX,JMX),WIPJ(IMX,JMX)
  4      12 |     &,WIJP(IMX,JMX),WIPJP(IMX,JMX)
         69 |      INCLUDE "BITMAP.comm"
  5       1 |C
  5       2 |      COMMON /BITMAP/
  5       3 |     & IBMAP(IMX,JMX)
         70 |      INCLUDE "IOUNIT.comm"
  6       1 |C
  6       2 |      INTEGER STDOUT
  6       3 |C
  6       4 |      COMMON /IOUNIT/
  6       5 |     & STDOUT, LCNTRL, LUNCO, LUNLL, LUNOUT
  6       6 |C
         71 |C
         72 |C     SET TOLERANCE LIMITS.
         73 |C
         74 |      DATA MXPASS,SPVC,SMALL /2,1.E20,1.E-4/
         75 |C
         76 |C******************************************************************
         77 |C     START INTERP3 HERE.
         78 |C
         79 |C     BILINEAR INTERPOLATION OF FILLED E-GRID TO OUTPUT GRID.
         80 |C     THE WEIGHT ARRAYS W*(I,J) ARE PASSED THROUGH COMMON
         81 |C     BLOCK LLGRDS.  WHILE INTERPOLATING, COMPUTE FIELD
         82 |C     AVERAGE ON OUTPUT GRID.
         83 |C
         84 |      SUM = 0.0
         85 |      NPTS=0
         86 |C
         87 |!$omp  parallel do
         88 |      DO J=1,JMOT
         89 |      DO I=1,IMOT
         90 |        GDOUT(I,J)=SPVC
         91 |      ENDDO
         92 |      ENDDO
         93 |C
         94 |!$omp  parallel do
         95 |!$omp& private(m,n)
         96 |      DO 120 J = 1,JMOT
         97 |      DO 120 I = 1,IMOT
         98 |c       GDOUT(I,J) = SPVC
         99 |        IBMAP(I,J) = IWGT(I,J)
        100 |        IF (IWGT(I,J).EQ.1) THEN
        101 |          M = IEGRD(I,J)
        102 |          N = JEGRD(I,J)
        103 |          GDOUT(I,J) =
        104 |     X        WIJ(I,J)  *EGFUL(M,N)   +
        105 |     X        WIPJ(I,J) *EGFUL(M+1,N) +
        106 |     X        WIJP(I,J) *EGFUL(M,N+1) +
        107 |     X        WIPJP(I,J)*EGFUL(M+1,N+1)
        108 |        ENDIF
        109 | 120  CONTINUE
        110 |C
        111 |      DO J=1,JMOT
        112 |      DO I=1,IMOT
        113 |        IF(IWGT(I,J).EQ.1)THEN
        114 |          SUM=SUM+GDOUT(I,J)
        115 |          NPTS=NPTS+1
        116 |        ENDIF
        117 |      ENDDO
        118 |      ENDDO
        119 |C
        120 |      IF(NPTS.EQ.0)THEN
        121 |        WRITE(STDOUT,*)'INTERP3:  OUTPUT GRID NPTS IS ZERO'
        122 |        RETURN
        123 |      ENDIF
        124 |      AVG=SUM/NPTS
        125 |C
        126 |C     DONE WITH INTERPOLATION.  FILL MISSING VALUES WITH BOUNDARY VALUES.
        127 |C
        128 |      CALL EXTEND(GDOUT,IMOT,JMOT,AVG,SPVC)
        129 |C
        130 |C     END OF ROUTINE.
        131 |C
        132 |      RETURN
        133 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
avg                              Static, Real(4), Offset: 0, Alignment: full word
                                 0-124.7@  0-128.35
 
bitmap                           Common Block, Alignment: double word
                                 5-2.15$
 
egful                            Reference argument, Real(4) (1:177, 1:143), Offset: 0, Alignment: full word
                                 0-62.12$  0-1.26  0-104.26  0-105.26  0-106.26  0-107.26
 
egrdi                            Common member, Real(4) (1:89, 1:143), Offset: 812812, Alignment: full word
                                 4-9.8$
 
egrdj                            Common member, Real(4) (1:89, 1:143), Offset: 863720, Alignment: double word
                                 4-9.23$
 
evlat                            Common member, Real(4) (1:177, 1:143), Offset: 610324, Alignment: full word
                                 4-8.8$
 
evlon                            Common member, Real(4) (1:177, 1:143), Offset: 711568, Alignment: quadruple word
                                 4-8.23$
 
extend                           External Subroutine
                                 0-128.12
 
fvtlon                           Common member, Real(4) (1:177, 1:143), Offset: 509080, Alignment: double word
                                 4-7.34$
 
gdlat                            Common member, Real(4) (1:89, 1:143), Offset: 0, Alignment: quadruple word
                                 4-3.8$
 
gdlon                            Common member, Real(4) (1:89, 1:143), Offset: 50908, Alignment: full word
                                 4-3.23$
 
gdout                            Reference argument, Real(4) (1:?, 1:?), Offset: 0, Alignment: full word
                                 0-62.27$  0-1.32  0-90.9@  0-103.11@  0-114.19  0-128.19
 
gdtlat                           Common member, Real(4) (1:89, 1:143), Offset: 101816, Alignment: double word
                                 4-4.8$
 
gdtlon                           Common member, Real(4) (1:89, 1:143), Offset: 152724, Alignment: full word
                                 4-4.24$
 
htlat                            Common member, Real(4) (1:89, 1:143), Offset: 203632, Alignment: quadruple word
                                 4-5.8$
 
htlon                            Common member, Real(4) (1:89, 1:143), Offset: 254540, Alignment: full word
                                 4-5.21$
 
i                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-89.10@  0-90.15  0-97.14@  0-99.15  0-99.27  0-100.18  0-101.21  0-102.21  0-103.17  0-104.19
                                 0-105.20  0-106.20  0-107.21  0-112.10@  0-113.17  0-114.25
 
ibessl                           Common member, Integer(4), Offset: 4, Alignment: full word
                                 3-2.30$
 
ibmap                            Common member, Integer(4) (1:89, 1:143), Offset: 0, Alignment: quadruple word
                                 5-3.8$  0-99.9@
 
idim1                            Parameter, Integer(4)
                                 1-14.17$
 
idim2                            Parameter, Integer(4)
                                 1-14.29$
 
iegrd                            Common member, Integer(4) (1:89, 1:143), Offset: 914628, Alignment: full word
                                 4-10.8$  0-101.15
 
iegrdk                           Common member, Integer(4) (1:89, 1:143), Offset: 305448, Alignment: double word
                                 4-6.8$
 
iflag                            Common member, Integer(4), Offset: 16, Alignment: quadruple word
                                 3-2.47$
 
igstl                            Parameter, Integer(4)
                                 1-9.17$  1-14.23
 
igstr                            Parameter, Integer(4)
                                 1-9.26$  1-14.44
 
im                               Parameter, Integer(4)
                                 1-3.18$  0-57.24  1-11.23  1-11.34  1-14.35  2-3.21  4-5.14  4-5.27  4-6.15  4-6.29  4-7.14  4-7.27
 
imot                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-61.15$  0-1.38  0-62.33  0-62.33  0-89.14  0-97.20  0-112.14  0-128.25
 
imt                              Parameter, Integer(4)
                                 0-57.18$  0-62.18  4-7.41  4-8.14  4-8.29
 
imx                              Parameter, Integer(4)
                                 2-3.17$  4-3.14  4-3.29  4-4.15  4-4.31  4-9.14  4-9.29  4-10.14  4-10.29  4-11.13  4-11.26
                                 4-11.40  4-12.13  4-12.28  5-3.14
 
inpes                            Parameter, Integer(4)
                                 1-6.17$  1-11.27  1-11.37  1-14.38
 
interp3                          Subroutine
                                 0-1.18$
 
ioffs                            Common member, Integer(4), Offset: 12, Alignment: full word
                                 3-2.41$
 
iounit                           Common Block, Alignment: double word
                                 6-4.15$
 
itail                            Parameter, Integer(4)
                                 1-11.17$
 
iwgt                             Common member, Integer(4) (1:89, 1:143), Offset: 1016444, Alignment: full word
                                 4-11.8$  0-99.22  0-100.13  0-113.12
 
j                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-88.10@  0-90.17  0-96.14@  0-99.17  0-99.29  0-100.20  0-101.23  0-102.23  0-103.19  0-104.21
                                 0-105.22  0-106.22  0-107.23  0-111.10@  0-113.19  0-114.27
 
jdim1                            Parameter, Integer(4)
                                 1-15.17$
 
jdim2                            Parameter, Integer(4)
                                 1-15.29$
 
jegrd                            Common member, Integer(4) (1:89, 1:143), Offset: 965536, Alignment: quadruple word
                                 4-10.23$  0-102.15
 
jegrdk                           Common member, Integer(4) (1:89, 1:143), Offset: 356356, Alignment: full word
                                 4-6.22$
 
jgstl                            Parameter, Integer(4)
                                 1-10.17$  1-15.23
 
jgstr                            Parameter, Integer(4)
                                 1-10.26$  1-15.44
 
jm                               Parameter, Integer(4)
                                 1-3.24$  0-57.33  1-12.23  1-12.34  1-15.35  2-3.28  4-5.17  4-5.30  4-6.18  4-6.32  4-7.17  4-7.30
 
jmot                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-61.20$  0-1.43  0-62.38  0-62.38  0-88.14  0-96.20  0-111.14  0-128.30
 
jmt                              Parameter, Integer(4)
                                 0-57.29$  0-62.22  4-7.45  4-8.18  4-8.33
 
jmx                              Parameter, Integer(4)
                                 2-3.24$  4-3.18  4-3.33  4-4.19  4-4.35  4-9.18  4-9.33  4-10.18  4-10.33  4-11.17  4-11.30
                                 4-11.44  4-12.17  4-12.32  5-3.18
 
jnpes                            Parameter, Integer(4)
                                 1-6.25$  1-12.27  1-12.37  1-15.38
 
jtail                            Parameter, Integer(4)
                                 1-12.17$
 
ksb                              Common member, Integer(4), Offset: 8, Alignment: double word
                                 3-2.37$
 
lcntrl                           Common member, Integer(4), Offset: 4, Alignment: full word
                                 6-5.16$
 
llgrds                           Common Block, Alignment: double word
                                 4-2.15$
 
lm                               Parameter, Integer(4)
                                 1-3.31$  2-3.47
 
lsm                              Parameter, Integer(4)
                                 1-3.37$
 
lunco                            Common member, Integer(4), Offset: 8, Alignment: double word
                                 6-5.24$
 
lunll                            Common member, Integer(4), Offset: 12, Alignment: full word
                                 6-5.31$
 
lunout                           Common member, Integer(4), Offset: 16, Alignment: quadruple word
                                 6-5.38$
 
m                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-101.11@  0-104.32  0-105.32  0-106.32  0-107.32
 
mxfld                            Parameter, Integer(4)
                                 2-3.31$
 
mxlvl                            Parameter, Integer(4)
                                 2-3.41$
 
mxpass                           Static, Integer(4), Offset: 0, Alignment: full word
                                 0-74.12*
 
n                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-102.11@  0-104.34  0-105.36  0-106.34  0-107.36
 
npts                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-85.7@  0-115.11@  0-115.16  0-120.10  0-124.15
 
options                          Common Block, Alignment: double word
                                 3-2.15$
 
satdel                           Common member, Real(4), Offset: 20, Alignment: full word
                                 3-2.53$
 
small                            Static, Real(4), Offset: 0, Alignment: full word
                                 0-74.24*
 
spval                            Common member, Real(4), Offset: 0, Alignment: quadruple word
                                 3-2.24$
 
spvc                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-74.19*  0-90.20  0-128.39
 
stdout                           Common member, Integer(4), Offset: 0, Alignment: quadruple word
                                 6-2.15$  6-5.8$  0-121.15
 
sum                              Static, Real(8), Offset: 0, Alignment: double word
                                 0-63.24$  0-84.7@  0-114.11@  0-114.15  0-124.11
 
vtlat                            Common member, Real(4) (1:89, 1:143), Offset: 407264, Alignment: quadruple word
                                 4-7.8$
 
vtlon                            Common member, Real(4) (1:89, 1:143), Offset: 458172, Alignment: full word
                                 4-7.21$
 
wij                              Common member, Real(4) (1:89, 1:143), Offset: 1067352, Alignment: double word
                                 4-11.22$  0-104.15
 
wijp                             Common member, Real(4) (1:89, 1:143), Offset: 1169168, Alignment: quadruple word
                                 4-12.8$  0-106.15
 
wipj                             Common member, Real(4) (1:89, 1:143), Offset: 1118260, Alignment: full word
                                 4-11.35$  0-105.15
 
wipjp                            Common member, Real(4) (1:89, 1:143), Offset: 1220076, Alignment: full word
                                 4-12.22$  0-107.15
 
** interp3   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    INTERP3.f                   12/18/08   11:40:51
     1    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/parmeta
                                      12/18/08   11:40:52      0      54
     2    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/parmout
                                      12/18/08   11:40:52      0      55
     3    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/OPTIONS.comm
                                      12/18/08   11:40:51      0      67
     4    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/LLGRDS.comm
                                      12/18/08   11:40:51      0      68
     5    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/BITMAP.comm
                                      12/18/08   11:40:50      0      69
     6    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/IOUNIT.comm
                                      12/18/08   11:40:51      0      70
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     176
1501-510  Compilation successful for file INTERP3.f.
1501-543  Object file created.
