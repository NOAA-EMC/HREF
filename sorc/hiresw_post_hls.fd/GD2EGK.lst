IBM XL Fortran for AIX, V12.1 (5724-U82) Version 12.01.0000.0001 --- /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/GD2EGK.f 12/22/08 15:45:51
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             ESCAPE          FULLPATH
         I4              INLGLUE         NOLIBESSL       NOLIBPOSIX
         OBJECT          SOURCE          STRICT          SWAPOMP
         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         ALIAS_SIZE(65536)     FIXED(72)             MAXMEM(-1)
         OPTIMIZE(2)           SPILLSIZE(2000)       STACKTEMP(0)
  
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR6)            ATTR(FULL)            AUTODBL(NONE)
         DESCRIPTOR(V1)        DIRECTIVE(IBM*,IBMT)  ENUM()
         FLAG(I,I)             FLOAT(RNDSNGL,MAF,FOLD,RNGCHK,SINGLE)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         SAVE(ALL)             TUNE(PWR6)            UNROLL(AUTO)
         XREF(FULL)            XLF2003(NOPOLYMORPHIC,NOBOZLITARGS,NOSTOPEXCEPT,NOVOLATILE,NOAUTOREALLOC,OLDNANINF)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC,OLDPAD)
  
>>>>> SOURCE SECTION <<<<<
          1 |      SUBROUTINE GD2EGK(IMOT,JMOT)
          2 |C
          3 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          4 |C                .      .    .
          5 |C SUBPROGRAM:    GD2EGK      MAP OUTPUT GRID TO E-GRID
          6 |C   PRGRMMR: TREADON         ORG: W/NP2      DATE: 92-12-23
          7 |C
          8 |C ABSTRACT:
          9 |C     THIS ROUTINE LOCATES THE (I,J) INDICES ON A SPECIFIED
         10 |C     OUTPUT GRID NEAREST TO E-GRID MASS (H) POINTS.
         11 |C   .
         12 |C
         13 |C PROGRAM HISTORY LOG:
         14 |C   ??-??-??  ???
         15 |C   92-12-23  RUSS TREADON - GENERALIZED CODE.
         16 |C   93-06-09  RUSS TREADON - EXPANDED COMMENTS.
         17 |C   98-06-04  BLACK - CONVERSION TO 2-D
         18 |C
         19 |C USAGE:    GD2EGK(IMOT,JMOT)
         20 |C   INPUT ARGUMENT LIST:
         21 |C     IMOT     - FIRST DIMENSION OF OUTPUT GRID.
         22 |C     JMOT     - SECOND DIMENSION OF OUTPUT GRID.
         23 |C
         24 |C   OUTPUT ARGUMENT LIST:
         25 |C     NONE
         26 |C
         27 |C   OUTPUT FILES:
         28 |C     NONE
         29 |C
         30 |C   SUBPROGRAMS CALLED:
         31 |C     UTILITIES:
         32 |C       NONE
         33 |C     LIBRARY:
         34 |C       COMMON   - LLGRDS
         35 |C                  IOUNIT
         36 |C
         37 |C   ATTRIBUTES:
         38 |C     LANGUAGE: FORTRAN
         39 |C     MACHINE : CRAY C-90
         40 |C$$$
         41 |C
         42 |C     INCLUDE E- AND OTUPUT GRID DIMENSIONS.
         43 |C     COMPUTE DEPENDENT PARAMETERS.
         44 |C------------------------------------------------------------------------
         45 |      INCLUDE "parmeta"
  1       1 |C-------------------------------------------------------------
  1       2 |C***  SET PRIMARY GRID DIMENSIONS AND PRESSURE OUTPUT LEVELS
  1       3 |      PARAMETER (IM=89,JM=143,LM=60,LSM=39)
  1       4 |C-------------------------------------------------------------
  1       5 |C***  SET THE NUMBER OF PEs IN THE I-DIRECTION AND J-DIRECTION
  1       6 |      PARAMETER(INPES=5,JNPES=6)
  1       7 |C-------------------------------------------------------------
  1       8 |C
  1       9 |      PARAMETER(IGSTL=-5,IGSTR=5)
  1      10 |      PARAMETER(JGSTL=-5,JGSTR=5)
  1      11 |      PARAMETER(ITAIL=IM-(INPES*(IM/INPES)))
  1      12 |      PARAMETER(JTAIL=JM-(JNPES*(JM/JNPES)))
  1      13 |C
  1      14 |      PARAMETER(IDIM1=IGSTL,IDIM2=IM/INPES+IGSTR+1)
  1      15 |      PARAMETER(JDIM1=JGSTL,JDIM2=JM/JNPES+JGSTR+1)
  1      16 |C
  1      17 |C-------------------------------------------------------------
         46 |      INCLUDE "parmout"
  2       1 |C     MAXIMUM DIMENSIONS FOR OUTPUT GRID, FIELDS, AND LEVELS.
  2       2 |C
  2       3 |      PARAMETER(IMX=IM,JMX=JM,MXFLD=250,MXLVL=LM)
         47 |C------------------------------------------------------------------------
         48 |      PARAMETER (IMT=2*IM-1, JMT=JM)
         49 |C------------------------------------------------------------------------
         50 |      INCLUDE "LLGRDS.comm"
  3       1 |C
  3       2 |      COMMON /LLGRDS/
  3       3 |     & GDLAT(IMX,JMX),GDLON(IMX,JMX)
  3       4 |     &,GDTLAT(IMX,JMX),GDTLON(IMX,JMX)
  3       5 |     &,HTLAT(IM,JM),HTLON(IM,JM)
  3       6 |     &,IEGRDK(IM,JM),JEGRDK(IM,JM)
  3       7 |     &,VTLAT(IM,JM),VTLON(IM,JM),FVTLON(IMT,JMT)
  3       8 |     &,EVLAT(IMT,JMT),EVLON(IMT,JMT)
  3       9 |     &,EGRDI(IMX,JMX),EGRDJ(IMX,JMX)
  3      10 |     &,IEGRD(IMX,JMX),JEGRD(IMX,JMX)
  3      11 |     &,IWGT(IMX,JMX),WIJ(IMX,JMX),WIPJ(IMX,JMX)
  3      12 |     &,WIJP(IMX,JMX),WIPJP(IMX,JMX)
         51 |      INCLUDE "IOUNIT.comm"
  4       1 |C
  4       2 |      INTEGER STDOUT
  4       3 |C
  4       4 |      COMMON /IOUNIT/
  4       5 |     & STDOUT, LCNTRL, LUNCO, LUNLL, LUNOUT
  4       6 |C
         52 |C
         53 |C************************************************************************
         54 |C     START GD2EGK.
         55 |C
         56 |      WRITE(STDOUT,*)'GD2EGK:  COMPUTE E-GRID (I,J) FOR CETLIH'
         57 |C
         58 |C     INITIALIZE TO MINUS ONE (A FLAG) THE ARRAYS WHICH WILL CONTAIN
         59 |C     THE OUTPUT GRID (I,J) NEAREST TO EACH E-GRID MASS POINT.
         60 |C
         61 |CMIC$ DO ALL VECTOR AUTOSCOPE
         62 |      DO J=1,JM
         63 |      DO I=1,IM
         64 |        IEGRDK(I,J)=-1
         65 |        JEGRDK(I,J)=-1
         66 |      ENDDO
         67 |      ENDDO
         68 |C
         69 |C     THE MAPPING EXCLUDES THE OUTERMOST TWO ROWS AND COLUMNS ON
         70 |C     THE OUTPUT GRID.  SET UPPER INDEX LIMITS ACCORDINGLY.
         71 |C
         72 |      JMOT2=JMOT-2
         73 |      IMOT2=IMOT-2
         74 |C
         75 |C     LOOP OVER THE E-GRID.  THE LOOP ON J MOVES US SOUTH TO NORTH
         76 |C     ON THE E-GRID.  THE LOOP ON K MOVES US WEST TO EAST ACROSS
         77 |C     THE J-TH ROW ON THE E-GRID.
         78 |C
         79 |      DO 175 J=3,JM-2
         80 |      IEND=IM-1-MOD(J+1,2)
         81 |C
         82 |      DO 175 I=2,IEND
         83 |C
         84 |C     SET THE MASS POINT TRANSFORMED LATITUDE AND LONGITUDE
         85 |C     FOR THE K-TH E-GRID MASS POINT ON ROW J.
         86 |C
         87 |      CLON=HTLON(I,J)
         88 |      CLAT=HTLAT(I,J)
         89 |      DLAT=0.
         90 |C
         91 |C           LOOP OVER THE OUTPUT GRID.  FOR THE CURRENT
         92 |C           (I.E., K-TH) E-GRID MASS POINT WE WANT TO
         93 |C           LOCATE THE NEAREST OUTPUT GRID (I,J) POINT.
         94 |C           NOTE THAT THE (LAT,LON) OF THE OUTPUT GRID HAVE
         95 |C           BEEN TRANSFORMED TO THE E-GRID REFERENCE FRAME.
         96 |C
         97 | 110  DO 130 JJ=2,JMOT2
         98 |      DO 120 II=2,IMOT2
         99 |      IF(CLON.GE.GDTLON(II+1,JJ))  GOTO 120
        100 |      IF(CLON.LT.GDTLON(II  ,JJ))  GOTO 120
        101 |C
        102 |C     WE HAVE THE I INDEX (IP) OF THE OUTPUT GRID POINT
        103 |C     CLOSEST TO THE K-TH E-GRID MASS POINT.  SAVE THIS
        104 |C     VALUE AND EXIT LOOP 120.
        105 |C
        106 |      IP=II
        107 |      IEGRDK(I,J)=IP
        108 |      GOTO 125
        109 | 120  CONTINUE
        110 |C
        111 |C     REACHING THIS LINE MEANS THAT IP HAS NOT BEEN IDENTIFIED
        112 |C     ON THIS ROW OF THE OUTPUT GRID SO MOVE TO THE NEXT ROW OF
        113 |C     THE OUTPUT GRID AND REPEAT THE PROCESS.
        114 |C
        115 |      GOTO 130
        116 |C
        117 |C     REACHING THIS POINT MEANS THAT WE HAVE THE I INDEX.
        118 |C     CHECK TO SEE IF THE LATITUDE OF THE JJ-TH OUTPUT GRID
        119 |C     POINT IN THE IP-TH COLUMN IS WITHIN DLAT OF THE LATITUDE
        120 |C     OF THE K-TH E-GRID MASS POINT.  IF SO, SAVE THE J INDEX
        121 |C     (JP) AND MOVE ON THE THE NEXT E-GRID MASS POINT.
        122 |C     OTHERWISE, MOVE ON THE THE NEXT ROW OF THE OUTPUT GRID
        123 |C     AND REPEAT THE SEARCH PROCESS.
        124 |C
        125 |  125 CONTINUE
        126 |C
        127 |      IF(CLAT.GE.(GDTLAT(IP,JJ+1)+DLAT))  GOTO 130
        128 |      IF(CLAT.LT.(GDTLAT(IP,JJ  )-DLAT))  GOTO 130
        129 |      JP=JJ
        130 |      JEGRDK(I,J)=JP
        131 |      GOTO 175
        132 |  130 CONTINUE
        133 |C
        134 |C     REACHING THIS BLOCK OF CODE MEANS THAT NO NEAREST NEIGHBOR
        135 |C     OUTPUT GRID POINT HAS BEEN IDENTIFIED.  THIS COULD HAVE
        136 |C     HAPPENED BECAUSE OF
        137 |C     (A) OBLIQUENESS OF TRANSFORMED GRID LINES, OR
        138 |C     (B) ETA GRID POINT BEING OUTSIDE THE OUTPUT GRID AREA.
        139 |C     WE ALLOW FOR (A) BY INCREASING THE TOLERANCE DLAT (UP TO
        140 |C     A LIMIT OF 0.1) AND REPEATING THE SEARCH.
        141 |C
        142 |      IF(DLAT.LT.0.1)THEN
        143 |        DLAT = DLAT + 0.005
        144 |        GOTO 110
        145 |      ENDIF
        146 |C
        147 |C     REACHING THIS LAST BLOCK OF CODE MEANS THAT WE CAN'T FIND
        148 |C     A NEAREST NEIGHBOR OUTPUT GRID POINT FOR THE K-TH E-GRID
        149 |C     MASS POINT.  SET I- AND J-EGRDK ARRAY TO -1 FOR THIS K.
        150 |C     (GRANTED, THIS IS OVERKILL, SINCE WE INITIALIZED THESE
        151 |C     ARRAYS TO -1.)
        152 |C
        153 |      IEGRDK(I,J)=-1
        154 |      JEGRDK(I,J)=-1
        155 |C
        156 |C     REPEAT SEARCH FOR NEXT E-GRID MASS POINT.
        157 |C
        158 | 175  CONTINUE
        159 |C
        160 |C     END OF ROUTINE.
        161 |C
        162 |      RETURN
        163 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
clat                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-88.7@  0-127.10  0-128.10
 
clon                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-87.7@  0-99.10  0-100.10
 
dlat                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-89.7@  0-127.35  0-128.35  0-142.10  0-143.9@  0-143.16
 
egrdi                            Common member, Real(4) (1:89, 1:143), Offset: 812812, Alignment: full word
                                 3-9.8$
 
egrdj                            Common member, Real(4) (1:89, 1:143), Offset: 863720, Alignment: double word
                                 3-9.23$
 
evlat                            Common member, Real(4) (1:177, 1:143), Offset: 610324, Alignment: full word
                                 3-8.8$
 
evlon                            Common member, Real(4) (1:177, 1:143), Offset: 711568, Alignment: quadruple word
                                 3-8.23$
 
fvtlon                           Common member, Real(4) (1:177, 1:143), Offset: 509080, Alignment: double word
                                 3-7.34$
 
gd2egk                           Subroutine
                                 0-1.18$
 
gdlat                            Common member, Real(4) (1:89, 1:143), Offset: 0, Alignment: quadruple word
                                 3-3.8$
 
gdlon                            Common member, Real(4) (1:89, 1:143), Offset: 50908, Alignment: full word
                                 3-3.23$
 
gdtlat                           Common member, Real(4) (1:89, 1:143), Offset: 101816, Alignment: double word
                                 3-4.8$  0-127.19  0-128.19
 
gdtlon                           Common member, Real(4) (1:89, 1:143), Offset: 152724, Alignment: full word
                                 3-4.24$  0-99.18  0-100.18
 
htlat                            Common member, Real(4) (1:89, 1:143), Offset: 203632, Alignment: quadruple word
                                 3-5.8$  0-88.12
 
htlon                            Common member, Real(4) (1:89, 1:143), Offset: 254540, Alignment: full word
                                 3-5.21$  0-87.12
 
i                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-63.10@  0-64.16  0-65.16  0-82.14@  0-87.18  0-88.18  0-107.14  0-130.14  0-153.14  0-154.14
 
idim1                            Parameter, Integer(4)
                                 1-14.17$
 
idim2                            Parameter, Integer(4)
                                 1-14.29$
 
iegrd                            Common member, Integer(4) (1:89, 1:143), Offset: 914628, Alignment: full word
                                 3-10.8$
 
iegrdk                           Common member, Integer(4) (1:89, 1:143), Offset: 305448, Alignment: double word
                                 3-6.8$  0-64.9@  0-107.7@  0-153.7@
 
iend                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-80.7@  0-82.18
 
igstl                            Parameter, Integer(4)
                                 1-9.17$  1-14.23
 
igstr                            Parameter, Integer(4)
                                 1-9.26$  1-14.44
 
ii                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-98.14@  0-99.25  0-100.25  0-106.10
 
im                               Parameter, Integer(4)
                                 1-3.18$  0-48.24  0-63.14  0-80.12  1-11.23  1-11.34  1-14.35  2-3.21  3-5.14  3-5.27  3-6.15
                                 3-6.29  3-7.14  3-7.27
 
imot                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.25  0-73.13
 
imot2                            Static, Integer(4), Offset: 0, Alignment: full word
                                 0-73.7@  0-98.19
 
imt                              Parameter, Integer(4)
                                 0-48.18$  3-7.41  3-8.14  3-8.29
 
imx                              Parameter, Integer(4)
                                 2-3.17$  3-3.14  3-3.29  3-4.15  3-4.31  3-9.14  3-9.29  3-10.14  3-10.29  3-11.13  3-11.26
                                 3-11.40  3-12.13  3-12.28
 
inpes                            Parameter, Integer(4)
                                 1-6.17$  1-11.27  1-11.37  1-14.38
 
iounit                           Common Block, Alignment: double word
                                 4-4.15$
 
ip                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-106.7@  0-107.19  0-127.26  0-128.26
 
itail                            Parameter, Integer(4)
                                 1-11.17$
 
iwgt                             Common member, Integer(4) (1:89, 1:143), Offset: 1016444, Alignment: full word
                                 3-11.8$
 
j                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-62.10@  0-64.18  0-65.18  0-79.14@  0-80.21  0-87.20  0-88.20  0-107.16  0-130.16  0-153.16
                                 0-154.16
 
jdim1                            Parameter, Integer(4)
                                 1-15.17$
 
jdim2                            Parameter, Integer(4)
                                 1-15.29$
 
jegrd                            Common member, Integer(4) (1:89, 1:143), Offset: 965536, Alignment: quadruple word
                                 3-10.23$
 
jegrdk                           Common member, Integer(4) (1:89, 1:143), Offset: 356356, Alignment: full word
                                 3-6.22$  0-65.9@  0-130.7@  0-154.7@
 
jgstl                            Parameter, Integer(4)
                                 1-10.17$  1-15.23
 
jgstr                            Parameter, Integer(4)
                                 1-10.26$  1-15.44
 
jj                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-97.14@  0-99.30  0-100.30  0-127.29  0-128.29  0-129.10
 
jm                               Parameter, Integer(4)
                                 1-3.24$  0-48.34  0-62.14  0-79.18  1-12.23  1-12.34  1-15.35  2-3.28  3-5.17  3-5.30  3-6.18
                                 3-6.32  3-7.17  3-7.30
 
jmot                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.30  0-72.13
 
jmot2                            Static, Integer(4), Offset: 0, Alignment: full word
                                 0-72.7@  0-97.19
 
jmt                              Parameter, Integer(4)
                                 0-48.30$  3-7.45  3-8.18  3-8.33
 
jmx                              Parameter, Integer(4)
                                 2-3.24$  3-3.18  3-3.33  3-4.19  3-4.35  3-9.18  3-9.33  3-10.18  3-10.33  3-11.17  3-11.30
                                 3-11.44  3-12.17  3-12.32
 
jnpes                            Parameter, Integer(4)
                                 1-6.25$  1-12.27  1-12.37  1-15.38
 
jp                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-129.7@  0-130.19
 
jtail                            Parameter, Integer(4)
                                 1-12.17$
 
lcntrl                           Common member, Integer(4), Offset: 4, Alignment: full word
                                 4-5.16$
 
llgrds                           Common Block, Alignment: double word
                                 3-2.15$
 
lm                               Parameter, Integer(4)
                                 1-3.31$  2-3.47
 
lsm                              Parameter, Integer(4)
                                 1-3.37$
 
lunco                            Common member, Integer(4), Offset: 8, Alignment: double word
                                 4-5.24$
 
lunll                            Common member, Integer(4), Offset: 12, Alignment: full word
                                 4-5.31$
 
lunout                           Common member, Integer(4), Offset: 16, Alignment: quadruple word
                                 4-5.38$
 
mod                              Pure Intrinsic
                                 0-80.17
 
mxfld                            Parameter, Integer(4)
                                 2-3.31$
 
mxlvl                            Parameter, Integer(4)
                                 2-3.41$
 
stdout                           Common member, Integer(4), Offset: 0, Alignment: quadruple word
                                 4-2.15$  4-5.8$  0-56.13
 
vtlat                            Common member, Real(4) (1:89, 1:143), Offset: 407264, Alignment: quadruple word
                                 3-7.8$
 
vtlon                            Common member, Real(4) (1:89, 1:143), Offset: 458172, Alignment: full word
                                 3-7.21$
 
wij                              Common member, Real(4) (1:89, 1:143), Offset: 1067352, Alignment: double word
                                 3-11.22$
 
wijp                             Common member, Real(4) (1:89, 1:143), Offset: 1169168, Alignment: quadruple word
                                 3-12.8$
 
wipj                             Common member, Real(4) (1:89, 1:143), Offset: 1118260, Alignment: full word
                                 3-11.35$
 
wipjp                            Common member, Real(4) (1:89, 1:143), Offset: 1220076, Alignment: full word
                                 3-12.22$
 
** gd2egk   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    GD2EGK.f                    12/18/08   11:40:51
     1    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/parmeta
                                      12/18/08   11:40:52      0      45
     2    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/parmout
                                      12/18/08   11:40:52      0      46
     3    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/LLGRDS.comm
                                      12/18/08   11:40:51      0      50
     4    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/IOUNIT.comm
                                      12/18/08   11:40:51      0      51
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     201
1501-510  Compilation successful for file GD2EGK.f.
1501-543  Object file created.
