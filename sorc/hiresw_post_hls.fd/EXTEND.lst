IBM XL Fortran for AIX, V12.1 (5724-U82) Version 12.01.0000.0001 --- /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/EXTEND.f 12/22/08 15:45:50
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             ESCAPE          FULLPATH
         I4              INLGLUE         NOLIBESSL       NOLIBPOSIX
         OBJECT          SOURCE          STRICT          SWAPOMP
         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         ALIAS_SIZE(65536)     FIXED(72)             MAXMEM(-1)
         OPTIMIZE(2)           SPILLSIZE(2000)       STACKTEMP(0)
  
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR6)            ATTR(FULL)            AUTODBL(NONE)
         DESCRIPTOR(V1)        DIRECTIVE(IBM*,IBMT)  ENUM()
         FLAG(I,I)             FLOAT(RNDSNGL,MAF,FOLD,RNGCHK,SINGLE)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         SAVE(ALL)             TUNE(PWR6)            UNROLL(AUTO)
         XREF(FULL)            XLF2003(NOPOLYMORPHIC,NOBOZLITARGS,NOSTOPEXCEPT,NOVOLATILE,NOAUTOREALLOC,OLDNANINF)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC,OLDPAD)
  
>>>>> SOURCE SECTION <<<<<
          1 |      SUBROUTINE EXTEND(GRID,IDIM,JDIM,AVG,SPVC)
          2 |C
          3 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          4 |C                .      .    .
          5 |C SUBPROGRAM:    EXTEND      FILL MISSING BOUNDARY VALUES.
          6 |C   PRGRMMR: TREADON         ORG: W/NP2      DATE: 93-02-03
          7 |C
          8 |C ABSTRACT:
          9 |C     THIS SUBROUTINE EXTENDS KNOW BOUNDARY VALUES TO FILL
         10 |C     MISSING VALUES TAGGED BY THE VALUE SPVC.  MULTIPLE
         11 |C     FILLING PASSES MAY BE MADE.  WE OPTED TO MAKE ONE
         12 |C     PASS AND REPLACE ANY REMAINING SPVC VALUES BY THE
         13 |C     FIELD MEAN.
         14 |C   .
         15 |C
         16 |C PROGRAM HISTORY LOG:
         17 |C   ??-??-??  DAVID PLUMMER - SOURCE IN ETAPACKC
         18 |C   93-02-26  RUSS TREADON  - GENERALIZED ETAPACKC SOURCE
         19 |C                             AND ADDED COMMENTS.
         20 |C   93-06-23  RUSS TREADON  - COMPLETE REWRITE.
         21 |C
         22 |C USAGE:    CALL EXTEND(GRID,IDIM,JDIM,AVG,SPVC)
         23 |C   INPUT ARGUMENT LIST:
         24 |C     GRID     - GRID TO BE FILLED.
         25 |C     IDIM     - FIRST DIMENSION OF GRID.
         26 |C     JDIM     - SECOND DIENSION OF GRID.
         27 |C     AVG      - VALUE TO REPLACE SPVC VALUES WITH AFTER
         28 |C                MXPASS FILLING PASSES OVER THE GRID.
         29 |C     SPVC     - THE MISSING DATA FLAG.
         30 |C
         31 |C   OUTPUT ARGUMENT LIST:
         32 |C     GRID     - GRID WITH SPVC VALUES REPLACED BY EXTENDED
         33 |C                BORDER VALUES OR PASSED VALUE OF AVG.
         34 |C
         35 |C   OUTPUT FILES:
         36 |C     STDOUT  - RUN TIME STANDARD OUT.
         37 |C
         38 |C   SUBPROGRAMS CALLED:
         39 |C     UTILITIES:
         40 |C       NONE
         41 |C     LIBRARY:
         42 |C       COMMON   - IOUNIT
         43 |C
         44 |C   ATTRIBUTES:
         45 |C     LANGUAGE: FORTRAN
         46 |C     MACHINE : CRAY C-90
         47 |C$$$
         48 |C
         49 |C
         50 |C
         51 |C     SET PARAMETERS
         52 |      PARAMETER (MXPASS=1)
         53 |C
         54 |C     DECLARE VARIABLES.
         55 |      REAL GRID(IDIM,JDIM)
         56 |C
         57 |C     INCLUDE COMMON BLOCK
         58 |      INCLUDE "IOUNIT.comm"
  1       1 |C
  1       2 |      INTEGER STDOUT
  1       3 |C
  1       4 |      COMMON /IOUNIT/
  1       5 |     & STDOUT, LCNTRL, LUNCO, LUNLL, LUNOUT
  1       6 |C
         59 |C
         60 |C**************************************************************************
         61 |C     START EXTEND HERE.
         62 |C
         63 |      print *,'EXTENDD ',idim,jdim
         64 |      IJDIM = IDIM*JDIM
         65 |C
         66 |C     FILL MISSING VALUES WITH BOUNDARY VALUES.  WE ALLOW
         67 |C     UP TO MXPASS EXTENSION PASSES TO ACCOMPLISH THIS.  THE
         68 |C     COMMENTS BELOW ASSUME GRID(1,1) IS IN THE SOUTHWEST OR
         69 |C     LOWER LEFT CORNER AND GRID(IDIM,JDIM) IS IN THE NORTHEAST
         70 |C     OR UPPER RIGHT CORNER.
         71 |C
         72 |
         73 |      IPASS = 0
         74 | 10   CONTINUE
         75 |      IPASS = IPASS + 1
         76 |C
         77 |C     EXTEND SOUTHERN AND NORTHERN BOUNDARIES.
         78 |      DO 70 I = 1,IDIM
         79 |C
         80 |C        EXTEND SOUTHERN BOUNDARY.
         81 |         DO 30 J = 1,JDIM
         82 |            IF (GRID(I,J).NE.SPVC) THEN
         83 |               DO 20 JJ = J,1,-1
         84 |                  GRID(I,JJ) = GRID(I,J)
         85 | 20            CONTINUE
         86 |               GOTO 40
         87 |            ENDIF
         88 | 30      CONTINUE
         89 |C
         90 |C        EXTEND NORTHERN BOUNDARY
         91 | 40      CONTINUE
         92 |         DO 60 J = JDIM,1,-1
         93 |            IF (GRID(I,J).NE.SPVC) THEN
         94 |               DO 50 JJ = J,JDIM
         95 |                  GRID(I,JJ) = GRID(I,J)
         96 | 50            CONTINUE
         97 |               GOTO 70
         98 |            ENDIF
         99 | 60      CONTINUE
        100 |C
        101 |C     REPEAT FOR NEXT COLUMN.
        102 | 70   CONTINUE
        103 |C
        104 |C     EXTEND WESTERN AND EASTERN BOUNDARIES
        105 |      DO 170 J = 1,JDIM
        106 |C
        107 |C        EXTEND WESTERN BOUNDARY
        108 |         DO 130 I = 1,IDIM
        109 |            IF (GRID(I,J).NE.SPVC) THEN
        110 |               DO 120 II = I,1,-1
        111 |                  GRID(II,J) = GRID(I,J)
        112 | 120           CONTINUE
        113 |               GOTO 140
        114 |            ENDIF
        115 | 130     CONTINUE
        116 |C
        117 |C        EXTEND EASTERN BOUNDARY
        118 | 140     CONTINUE
        119 |         DO 160 I = IDIM,1,-1
        120 |            IF (GRID(I,J).NE.SPVC) THEN
        121 |               DO 150 II = I,IDIM
        122 |                  GRID(II,J) = GRID(I,J)
        123 | 150           CONTINUE
        124 |               GOTO 170
        125 |            ENDIF
        126 | 160     CONTINUE
        127 |C
        128 |C     REPEAT FOR NEXT ROW
        129 | 170  CONTINUE
        130 |C
        131 |C     SEE IF WE NEED TO MAKE ANOTHER PASS.
        132 |C
        133 |      CALL MINMAX(GRID,IDIM,JDIM,FMIN,FMAX)
        134 |      IF (FMAX.GE.SPVC) THEN
        135 |CX         WRITE(STDOUT,*)'EXTEND:  BOUNDARY FILL:  ',IPASS,FMIN,FMAX
        136 |         IF (IPASS.LT.MXPASS) GOTO 10
        137 |      ENDIF
        138 |C
        139 |C     IF WE STILL CAN'T FILL THE GRID AFTER MXPASS PASSES,
        140 |C     FILL MISSING VALUES WITH FIELD MEAN.
        141 |C
        142 |      IF ((FMAX.GE.SPVC).AND.(IPASS.GE.MXPASS)) THEN
        143 |CX         WRITE(STDOUT,*)'EXTEND:  FILLING WITH AVG=',AVG
        144 |!$omp  parallel do
        145 |         DO 180 J = 1,JDIM
        146 |         DO 180 I = 1,IDIM
        147 |            IF (GRID(I,J).GE.SPVC) GRID(I,J) = AVG
        148 | 180     CONTINUE
        149 |      ENDIF
        150 |C
        151 |C     END OF ROUTINE.
        152 |C
        153 |      RETURN
        154 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
avg                              Reference argument, Real(4), Offset: 0, Alignment: full word
                                 0-1.40  0-147.48
 
extend                           Subroutine
                                 0-1.18$
 
fmax                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-133.39  0-134.11  0-142.12
 
fmin                             Static, Real(4), Offset: 0, Alignment: full word
                                 0-133.34
 
grid                             Reference argument, Real(4) (1:?, 1:?), Offset: 0, Alignment: full word
                                 0-55.12$  0-1.25  0-82.17  0-84.19@  0-84.32  0-93.17  0-95.19@  0-95.32  0-109.17  0-111.19@
                                 0-111.32  0-120.17  0-122.19@  0-122.32  0-133.19  0-147.17  0-147.36@
 
i                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-78.13@  0-82.22  0-84.24  0-84.37  0-93.22  0-95.24  0-95.37  0-108.17@  0-109.22  0-110.28
                                 0-111.37  0-119.17@  0-120.22  0-121.28  0-122.37  0-146.17@  0-147.22  0-147.41
 
idim                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.30  0-55.17  0-55.17  0-63.26  0-64.15  0-78.19  0-108.23  0-119.21  0-121.30  0-133.24
                                 0-146.23
 
ii                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-110.23@  0-111.24  0-121.23@  0-122.24
 
ijdim                            Static, Integer(4), Offset: 0, Alignment: full word
                                 0-64.7@
 
iounit                           Common Block, Alignment: double word
                                 1-4.15$
 
ipass                            Static, Integer(4), Offset: 0, Alignment: full word
                                 0-73.7@  0-75.7@  0-75.15  0-136.14  0-142.31
 
j                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-81.16@  0-82.24  0-83.27  0-84.39  0-92.16@  0-93.24  0-94.27  0-95.39  0-105.14@  0-109.24
                                 0-111.27  0-111.39  0-120.24  0-122.27  0-122.39  0-145.17@  0-147.24  0-147.43
 
jdim                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.35  0-55.22  0-55.22  0-63.31  0-64.20  0-81.22  0-92.20  0-94.29  0-105.20  0-133.29  0-145.23
 
jj                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-83.22@  0-84.26  0-94.22@  0-95.26
 
lcntrl                           Common member, Integer(4), Offset: 4, Alignment: full word
                                 1-5.16$
 
lunco                            Common member, Integer(4), Offset: 8, Alignment: double word
                                 1-5.24$
 
lunll                            Common member, Integer(4), Offset: 12, Alignment: full word
                                 1-5.31$
 
lunout                           Common member, Integer(4), Offset: 16, Alignment: quadruple word
                                 1-5.38$
 
minmax                           External Subroutine
                                 0-133.12
 
mxpass                           Parameter, Integer(4)
                                 0-52.18$  0-136.23  0-142.40
 
spvc                             Reference argument, Real(4), Offset: 0, Alignment: full word
                                 0-1.44  0-82.30  0-93.30  0-109.30  0-120.30  0-134.19  0-142.20  0-147.30
 
stdout                           Common member, Integer(4), Offset: 0, Alignment: quadruple word
                                 1-2.15$  1-5.8$
 
** extend   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    EXTEND.f                    12/18/08   11:40:51
     1    /gpfs/c/nco/ops/nwprod/sorc/hiresw_post_hls.fd/IOUNIT.comm
                                      12/18/08   11:40:51      0      58
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     160
1501-510  Compilation successful for file EXTEND.f.
1501-543  Object file created.
