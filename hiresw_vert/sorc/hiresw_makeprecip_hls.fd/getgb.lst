IBM XL Fortran for AIX, V12.1 (5724-U82) Version 12.01.0000.0001 --- /gpfs/c/nco/ops/nwprod/sorc/hiresw_makeprecip_hls.fd/getgb.f 12/22/08 15:32:54
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             DDIM            ESCAPE
         FULLPATH        I4              INLGLUE         NOLIBESSL
         NOLIBPOSIX      OBJECT          SOURCE          STRICT
         SWAPOMP         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         ALIAS_SIZE(65536)     FIXED(72)             MAXMEM(-1)
         OPTIMIZE(2)           SPILLSIZE(548)        STACKTEMP(0)
  
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR6)            ATTR()                AUTODBL(NONE)
         DESCRIPTOR(V1)        DIRECTIVE(IBM*,IBMT)  ENUM()
         FLAG(I,I)             FLOAT(RNDSNGL,MAF,FOLD,RNGCHK,SINGLE)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         NOSAVE()              TUNE(PWR6)            UNROLL(AUTO)
         XREF(FULL)            XLF2003(NOPOLYMORPHIC,NOBOZLITARGS,NOSTOPEXCEPT,NOVOLATILE,NOAUTOREALLOC,OLDNANINF)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC,OLDPAD)
  
>>>>> SOURCE SECTION <<<<<
          1 |C-----------------------------------------------------------------------
          2 |      SUBROUTINE GETGB(LUGB,LUGI,JF,J,JPDS,JGDS,
          3 |     &                 KF,K,KPDS,KGDS,LB,F,NBITSS,IBSS,IRET)
          4 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          5 |C
          6 |C SUBPROGRAM: GETGB          FINDS AND UNPACKS A GRIB MESSAGE
          7 |C   PRGMMR: IREDELL          ORG: W/NMC23     DATE: 94-04-01
          8 |C
          9 |C ABSTRACT: FIND AND UNPACK A GRIB MESSAGE.
         10 |C   READ A GRIB INDEX FILE (OR OPTIONALLY THE GRIB FILE ITSELF)
         11 |C   TO GET THE INDEX BUFFER (I.E. TABLE OF CONTENTS) FOR THE GRIB FILE.
         12 |C   (THE INDEX BUFFER IS SAVED FOR USE BY FUTURE PROSPECTIVE CALLS.)
         13 |C   FIND IN THE INDEX BUFFER A REFERENCE TO THE GRIB MESSAGE REQUESTED.
         14 |C   THE GRIB MESSAGE REQUEST SPECIFIES THE NUMBER OF MESSAGES TO SKIP
         15 |C   AND THE UNPACKED PDS AND GDS PARAMETERS.  (A REQUESTED PARAMETER
         16 |C   OF -1 MEANS TO ALLOW ANY VALUE OF THIS PARAMETER TO BE FOUND.)
         17 |C   IF THE REQUESTED GRIB MESSAGE IS FOUND, THEN IT IS READ FROM THE
         18 |C   GRIB FILE AND UNPACKED.  ITS MESSAGE NUMBER IS RETURNED ALONG WITH
         19 |C   THE UNPACKED PDS AND GDS PARAMETERS, THE UNPACKED BITMAP (IF ANY),
         20 |C   AND THE UNPACKED DATA.  IF THE GRIB MESSAGE IS NOT FOUND, THEN THE
         21 |C   RETURN CODE WILL BE NONZERO.
         22 |C
         23 |C PROGRAM HISTORY LOG:
         24 |C   94-04-01  IREDELL
         25 |C   95-10-31  IREDELL     MODULARIZED PORTIONS OF CODE INTO SUBPROGRAMS
         26 |C                         AND ALLOWED FOR UNSPECIFIED INDEX FILE
         27 |C
         28 |C USAGE:    CALL GETGB(LUGB,LUGI,JF,J,JPDS,JGDS,
         29 |C    &                 KF,K,KPDS,KGDS,LB,F,IRET)
         30 |C   INPUT ARGUMENTS:
         31 |C     LUGB         INTEGER UNIT OF THE UNBLOCKED GRIB DATA FILE
         32 |C     LUGI         INTEGER UNIT OF THE UNBLOCKED GRIB INDEX FILE
         33 |C                  (=0 TO GET INDEX BUFFER FROM THE GRIB FILE)
         34 |C     JF           INTEGER MAXIMUM NUMBER OF DATA POINTS TO UNPACK
         35 |C     J            INTEGER NUMBER OF MESSAGES TO SKIP
         36 |C                  (=0 TO SEARCH FROM BEGINNING)
         37 |C                  (<0 TO READ INDEX BUFFER AND SKIP -1-J MESSAGES)
         38 |C     JPDS         INTEGER (200) PDS PARAMETERS FOR WHICH TO SEARCH
         39 |C                  (=-1 FOR WILDCARD)
         40 |C          (1)   - ID OF CENTER
         41 |C          (2)   - GENERATING PROCESS ID NUMBER
         42 |C          (3)   - GRID DEFINITION
         43 |C          (4)   - GDS/BMS FLAG (RIGHT ADJ COPY OF OCTET 8)
         44 |C          (5)   - INDICATOR OF PARAMETER
         45 |C          (6)   - TYPE OF LEVEL
         46 |C          (7)   - HEIGHT/PRESSURE , ETC OF LEVEL
         47 |C          (8)   - YEAR INCLUDING (CENTURY-1)
         48 |C          (9)   - MONTH OF YEAR
         49 |C          (10)  - DAY OF MONTH
         50 |C          (11)  - HOUR OF DAY
         51 |C          (12)  - MINUTE OF HOUR
         52 |C          (13)  - INDICATOR OF FORECAST TIME UNIT
         53 |C          (14)  - TIME RANGE 1
         54 |C          (15)  - TIME RANGE 2
         55 |C          (16)  - TIME RANGE FLAG
         56 |C          (17)  - NUMBER INCLUDED IN AVERAGE
         57 |C          (18)  - VERSION NR OF GRIB SPECIFICATION
         58 |C          (19)  - VERSION NR OF PARAMETER TABLE
         59 |C          (20)  - NR MISSING FROM AVERAGE/ACCUMULATION
         60 |C          (21)  - CENTURY OF REFERENCE TIME OF DATA
         61 |C          (22)  - UNITS DECIMAL SCALE FACTOR
         62 |C          (23)  - SUBCENTER NUMBER
         63 |C          (24)  - PDS BYTE 29, FOR NMC ENSEMBLE PRODUCTS
         64 |C                  128 IF FORECAST FIELD ERROR
         65 |C                   64 IF BIAS CORRECTED FCST FIELD
         66 |C                   32 IF SMOOTHED FIELD
         67 |C                  WARNING: CAN BE COMBINATION OF MORE THAN 1
         68 |C          (25)  - PDS BYTE 30, NOT USED
         69 |C     JGDS         INTEGER (200) GDS PARAMETERS FOR WHICH TO SEARCH
         70 |C                  (ONLY SEARCHED IF JPDS(3)=255)
         71 |C                  (=-1 FOR WILDCARD)
         72 |C          (1)   - DATA REPRESENTATION TYPE
         73 |C          (19)  - NUMBER OF VERTICAL COORDINATE PARAMETERS
         74 |C          (20)  - OCTET NUMBER OF THE LIST OF VERTICAL COORDINATE
         75 |C                  PARAMETERS
         76 |C                  OR
         77 |C                  OCTET NUMBER OF THE LIST OF NUMBERS OF POINTS
         78 |C                  IN EACH ROW
         79 |C                  OR
         80 |C                  255 IF NEITHER ARE PRESENT
         81 |C          (21)  - FOR GRIDS WITH PL, NUMBER OF POINTS IN GRID
         82 |C          (22)  - NUMBER OF WORDS IN EACH ROW
         83 |C       LATITUDE/LONGITUDE GRIDS
         84 |C          (2)   - N(I) NR POINTS ON LATITUDE CIRCLE
         85 |C          (3)   - N(J) NR POINTS ON LONGITUDE MERIDIAN
         86 |C          (4)   - LA(1) LATITUDE OF ORIGIN
         87 |C          (5)   - LO(1) LONGITUDE OF ORIGIN
         88 |C          (6)   - RESOLUTION FLAG (RIGHT ADJ COPY OF OCTET 17)
         89 |C          (7)   - LA(2) LATITUDE OF EXTREME POINT
         90 |C          (8)   - LO(2) LONGITUDE OF EXTREME POINT
         91 |C          (9)   - DI LONGITUDINAL DIRECTION OF INCREMENT
         92 |C          (10)  - DJ LATITUDINAL DIRECTION INCREMENT
         93 |C          (11)  - SCANNING MODE FLAG (RIGHT ADJ COPY OF OCTET 28)
         94 |C       GAUSSIAN  GRIDS
         95 |C          (2)   - N(I) NR POINTS ON LATITUDE CIRCLE
         96 |C          (3)   - N(J) NR POINTS ON LONGITUDE MERIDIAN
         97 |C          (4)   - LA(1) LATITUDE OF ORIGIN
         98 |C          (5)   - LO(1) LONGITUDE OF ORIGIN
         99 |C          (6)   - RESOLUTION FLAG  (RIGHT ADJ COPY OF OCTET 17)
        100 |C          (7)   - LA(2) LATITUDE OF EXTREME POINT
        101 |C          (8)   - LO(2) LONGITUDE OF EXTREME POINT
        102 |C          (9)   - DI LONGITUDINAL DIRECTION OF INCREMENT
        103 |C          (10)  - N - NR OF CIRCLES POLE TO EQUATOR
        104 |C          (11)  - SCANNING MODE FLAG (RIGHT ADJ COPY OF OCTET 28)
        105 |C          (12)  - NV - NR OF VERT COORD PARAMETERS
        106 |C          (13)  - PV - OCTET NR OF LIST OF VERT COORD PARAMETERS
        107 |C                             OR
        108 |C                  PL - LOCATION OF THE LIST OF NUMBERS OF POINTS IN
        109 |C                       EACH ROW (IF NO VERT COORD PARAMETERS
        110 |C                       ARE PRESENT
        111 |C                             OR
        112 |C                  255 IF NEITHER ARE PRESENT
        113 |C       POLAR STEREOGRAPHIC GRIDS
        114 |C          (2)   - N(I) NR POINTS ALONG LAT CIRCLE
        115 |C          (3)   - N(J) NR POINTS ALONG LON CIRCLE
        116 |C          (4)   - LA(1) LATITUDE OF ORIGIN
        117 |C          (5)   - LO(1) LONGITUDE OF ORIGIN
        118 |C          (6)   - RESOLUTION FLAG  (RIGHT ADJ COPY OF OCTET 17)
        119 |C          (7)   - LOV GRID ORIENTATION
        120 |C          (8)   - DX - X DIRECTION INCREMENT
        121 |C          (9)   - DY - Y DIRECTION INCREMENT
        122 |C          (10)  - PROJECTION CENTER FLAG
        123 |C          (11)  - SCANNING MODE (RIGHT ADJ COPY OF OCTET 28)
        124 |C       SPHERICAL HARMONIC COEFFICIENTS
        125 |C          (2)   - J PENTAGONAL RESOLUTION PARAMETER
        126 |C          (3)   - K      "          "         "
        127 |C          (4)   - M      "          "         "
        128 |C          (5)   - REPRESENTATION TYPE
        129 |C          (6)   - COEFFICIENT STORAGE MODE
        130 |C       MERCATOR GRIDS
        131 |C          (2)   - N(I) NR POINTS ON LATITUDE CIRCLE
        132 |C          (3)   - N(J) NR POINTS ON LONGITUDE MERIDIAN
        133 |C          (4)   - LA(1) LATITUDE OF ORIGIN
        134 |C          (5)   - LO(1) LONGITUDE OF ORIGIN
        135 |C          (6)   - RESOLUTION FLAG (RIGHT ADJ COPY OF OCTET 17)
        136 |C          (7)   - LA(2) LATITUDE OF LAST GRID POINT
        137 |C          (8)   - LO(2) LONGITUDE OF LAST GRID POINT
        138 |C          (9)   - LATIT - LATITUDE OF PROJECTION INTERSECTION
        139 |C          (10)  - RESERVED
        140 |C          (11)  - SCANNING MODE FLAG (RIGHT ADJ COPY OF OCTET 28)
        141 |C          (12)  - LONGITUDINAL DIR GRID LENGTH
        142 |C          (13)  - LATITUDINAL DIR GRID LENGTH
        143 |C       LAMBERT CONFORMAL GRIDS
        144 |C          (2)   - NX NR POINTS ALONG X-AXIS
        145 |C          (3)   - NY NR POINTS ALONG Y-AXIS
        146 |C          (4)   - LA1 LAT OF ORIGIN (LOWER LEFT)
        147 |C          (5)   - LO1 LON OF ORIGIN (LOWER LEFT)
        148 |C          (6)   - RESOLUTION (RIGHT ADJ COPY OF OCTET 17)
        149 |C          (7)   - LOV - ORIENTATION OF GRID
        150 |C          (8)   - DX - X-DIR INCREMENT
        151 |C          (9)   - DY - Y-DIR INCREMENT
        152 |C          (10)  - PROJECTION CENTER FLAG
        153 |C          (11)  - SCANNING MODE FLAG (RIGHT ADJ COPY OF OCTET 28)
        154 |C          (12)  - LATIN 1 - FIRST LAT FROM POLE OF SECANT CONE INTER
        155 |C          (13)  - LATIN 2 - SECOND LAT FROM POLE OF SECANT CONE INTER
        156 |C   OUTPUT ARGUMENTS:
        157 |C     KF           INTEGER NUMBER OF DATA POINTS UNPACKED
        158 |C     K            INTEGER MESSAGE NUMBER UNPACKED
        159 |C                  (CAN BE SAME AS J IN CALLING PROGRAM
        160 |C                  IN ORDER TO FACILITATE MULTIPLE SEARCHES)
        161 |C     KPDS         INTEGER (200) UNPACKED PDS PARAMETERS
        162 |C     KGDS         INTEGER (200) UNPACKED GDS PARAMETERS
        163 |C     LB           LOGICAL*1 (KF) UNPACKED BITMAP IF PRESENT
        164 |C     F            REAL (KF) UNPACKED DATA
        165 |C     IRET         INTEGER RETURN CODE
        166 |C                    0      ALL OK
        167 |C                    96     ERROR READING INDEX FILE
        168 |C                    97     ERROR READING GRIB FILE
        169 |C                    98     NUMBER OF DATA POINTS GREATER THAN JF
        170 |C                    99     REQUEST NOT FOUND
        171 |C                    OTHER  W3FI63 GRIB UNPACKER RETURN CODE
        172 |C
        173 |C SUBPROGRAMS CALLED:
        174 |C   GETGBM         FIND AND UNPACK GRIB MESSAGE
        175 |C
        176 |C REMARKS: IN ORDER TO UNPACK GRIB FROM A MULTIPROCESSING ENVIRONMENT
        177 |C   WHERE EACH PROCESSOR IS ATTEMPTING TO READ FROM ITS OWN PAIR OF
        178 |C   LOGICAL UNITS, ONE MUST DIRECTLY CALL SUBPROGRAM GETGBM AS BELOW,
        179 |C   ALLOCATING A PRIVATE COPY OF CBUF, NLEN AND NNUM TO EACH PROCESSOR.
        180 |C   DO NOT ENGAGE THE SAME LOGICAL UNIT FROM MORE THAN ONE PROCESSOR.
        181 |C
        182 |C ATTRIBUTES:
        183 |C   LANGUAGE: FORTRAN 77
        184 |C   MACHINE:  CRAY, WORKSTATIONS
        185 |C
        186 |C$$$
        187 |      INTEGER JPDS(200),JGDS(200),KPDS(200),KGDS(200)
        188 |      LOGICAL*1 LB(JF)
        189 |      REAL F(JF)
        190 |      PARAMETER(MBUF=256*1024)
        191 |      CHARACTER CBUF(MBUF)
        192 |      SAVE CBUF,NLEN,NNUM,MNUM
        193 |      DATA LUX/0/
        194 |C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        195 |C  DETERMINE WHETHER INDEX BUFFER NEEDS TO BE INITIALIZED
        196 |      IF(LUGI.GT.0.AND.(J.LT.0.OR.LUGI.NE.LUX)) THEN
        197 |        LUX=LUGI
        198 |        JJ=MIN(J,-1-J)
        199 |      ELSEIF(LUGI.LE.0.AND.(J.LT.0.OR.LUGB.NE.LUX)) THEN
        200 |        LUX=LUGB
        201 |        JJ=MIN(J,-1-J)
        202 |      ELSE
        203 |        JJ=J
        204 |      ENDIF
        205 |C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        206 |C  FIND AND UNPACK GRIB MESSAGE
        207 |      CALL GETGBM(LUGB,LUGI,JF,JJ,JPDS,JGDS,
        208 |     &            MBUF,CBUF,NLEN,NNUM,MNUM,
        209 |     &            KF,K,KPDS,KGDS,LB,F,NBITSS,IBSS,IRET)
        210 |      IF(IRET.EQ.96) LUX=0
        211 |C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        212 |      RETURN
        213 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
cbuf                             Static, Character(1) (1:262144), Offset: 0, Alignment: full word
                                 0-191.17$  0-192.12$  0-208.24
 
f                                Reference argument, Real(4) (1:?), Offset: 0, Alignment: full word
                                 0-189.12$  0-3.42  0-209.37
 
getgb                            Subroutine
                                 0-2.18$
 
getgbm                           External Subroutine
                                 0-207.12
 
ibss                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-3.51  0-209.46
 
iret                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-3.56  0-209.51  0-210.10
 
j                                Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-2.37  0-196.25  0-198.16  0-198.21  0-199.29  0-201.16  0-201.21  0-203.12
 
jf                               Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-2.34  0-188.20  0-188.20  0-189.14  0-189.14  0-207.29
 
jgds                             Reference argument, Integer(4) (1:200), Offset: 0, Alignment: full word
                                 0-187.25$  0-2.44  0-207.40
 
jj                               Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-198.9@  0-201.9@  0-203.9@  0-207.32
 
jpds                             Reference argument, Integer(4) (1:200), Offset: 0, Alignment: full word
                                 0-187.15$  0-2.39  0-207.35
 
k                                Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-3.27  0-209.22
 
kf                               Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-3.24  0-209.19
 
kgds                             Reference argument, Integer(4) (1:200), Offset: 0, Alignment: full word
                                 0-187.45$  0-3.34  0-209.29
 
kpds                             Reference argument, Integer(4) (1:200), Offset: 0, Alignment: full word
                                 0-187.35$  0-3.29  0-209.24
 
lb                               Reference argument, Logical(1) (1:?), Offset: 0, Alignment: byte
                                 0-188.17$  0-3.39  0-209.34
 
lugb                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-2.24  0-199.39  0-200.13  0-207.19
 
lugi                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-2.29  0-196.10  0-196.35  0-197.13  0-199.14  0-207.24
 
lux                              Static, Integer(4), Offset: 0, Alignment: full word
                                 0-193.12*  0-196.43  0-197.9@  0-199.47  0-200.9@  0-210.22@
 
mbuf                             Parameter, Integer(4)
                                 0-190.17$  0-191.22  0-208.19
 
min                              Pure Intrinsic
                                 0-198.12  0-201.12
 
mnum                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-192.27$  0-208.39
 
nbitss                           Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-3.44  0-209.39
 
nlen                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-192.17$  0-208.29
 
nnum                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-192.22$  0-208.34
 
** getgb   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    getgb.f                     12/18/08   11:53:43
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     213
1501-510  Compilation successful for file getgb.f.
1501-543  Object file created.
